<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns:sm="http://servicemix.apache.org/config/1.0" xmlns:risktx="http://risktx.org/risktx-1.0">

	<sm:container id="jbi" useMBeanServer="true" createMBeanServer="true">

		<sm:activationSpecs>

			<sm:activationSpec componentName="fileSender" service="risktx:fileSender">
				<sm:component>
					<bean class="org.apache.servicemix.components.file.FileWriter">
						<property name="directory" value="outbox" />
						<property name="marshaler">
							<bean class="org.apache.servicemix.components.util.DefaultFileMarshaler">
								<property name="fileName">
									<bean class="org.apache.servicemix.expression.JaxenStringXPathExpression">
										<constructor-arg
											value="concat('sample_', /sample/@id, '.xml')" />
									</bean>
								</property>
							</bean>
						</property>
					</bean>
				</sm:component>
			</sm:activationSpec>

			<sm:activationSpec componentName="filePoller" destinationService="risktx:fileSender" service="risktx:filePoller">
				<sm:component>
					<bean class="org.apache.servicemix.components.file.FilePoller">
						<property name="file" value="inbox" />
						<property name="period" value="1000" />
					</bean>
				</sm:component>
			</sm:activationSpec>
		</sm:activationSpecs>
	</sm:container>

</beans>
